#!/bin/bash
# Main configuration for Restreaming Setup

# Base directory for configuration files (nginx.conf, stunnel.conf)
# If you move the NG-S4 project, update these paths accordingly,
# or modify scripts to derive them dynamically relative to their own location.
thisDr="$(dirname "$0")"
export envDr="$thisDr/real.env"

# Base directory for scripts
export scriptsDr="$thisDr/UNIX-Scripts" # Updated path

# --- STREAM KEYS AND APPLICATION CONFIGURATION ---
# !!! REPLACE THESE WITH YOUR ACTUAL STREAM KEYS !!!
export XX_TW_KEY="your_twitch_stream_key_here"
export XX_YT_KEY="your_youtube_stream_key_here"
export XX_KI_KEY="your_kick_stream_key_here"

# Nginx application names (must match application blocks in nginx.conf)
export APP_TW="XX_TW"
export APP_YT="XX_YT"
export APP_KI="XX_KI"
export APP_ALL="XX-All" # Matches the new nginx.conf
export APP_HLS="hls_app" # For HLS output
export APP_CAM1="Cam1"     # For camera input
export APP_MULTI="MultiMain" # For stream composition
export APP_TRANSCODE="XX_TC" # New transcoding app
export APP_MAIN_STREAM="MainStream" # New main consolidated app
export APP_SHORTS_COMBINED="ShortsCombined" # New combined shorts app

# Full push URLs (base part, before the key)
# These are primarily for reference or if a script needs to construct full URLs.
# The example nginx.conf now pushes to local stunnel ports for YT/Kick.
export PUSH_URL_TW_BASE="rtmp://live-lhr08.twitch.tv/app/" # Example Twitch ingest

# For YouTube, nginx.conf pushes to local stunnel port 19351
export PUSH_URL_YT_STUNNEL_BASE="rtmp://127.0.0.1:19351/live2/"
# Direct RTMPS URL for reference (stunnel connects to this)
export PUSH_URL_YT_DIRECT_BASE="rtmps://a.rtmp.youtube.com/live2/"

# For Kick, nginx.conf pushes to local stunnel port 19352
export PUSH_URL_KI_STUNNEL_BASE="rtmp://127.0.0.1:19352/app/"
# Direct RTMPS URL for reference (stunnel connects to this - actual endpoint may vary)
export PUSH_URL_KI_DIRECT_BASE="xxNNNxxNxNNN.global-contribute.live-video.net/app/"

# New stream key for the combined shorts YouTube push
export XX_SHORTS_YT_KEY="your_youtube_shorts_stream_key_here"

# --- OTHER CONFIGURATIONS ---
# User and group for Nginx worker processes and web content ownership
export NGINX_USER="www-data"
export NGINX_GROUP="www-data"

# Source for Nginx web content (e.g., HTML files for a status page)
# Set to "" if no web content needs to be copied by setup-restream.sh
export NGINX_WEB_CONTENT_SRC="$thisDr/../WEB/NGINX"
export NGINX_WEB_ROOT="/var/www/html" # Standard web root

# Base directory for HLS streams (must match hls_path in nginx.conf)
export HLS_BASE_DIR="/mnt/hls" # Updated to /mnt/hls as per expanded-nginx.conf logic

# Nginx HTTP Listen Port
export NGINX_HTTP_PORT="8080" # Defaulting to 8080 as in expanded-nginx.conf

# SSL Certificate Subject for stunnel (customize as needed)
export STUNNEL_SSL_SUBJECT="/C=US/ST=California/L=YourCity/O=YourOrganization/CN=yourdomain.com"

# Log directory for reset script
export LOG_DIR="/home/jnxlr/PROJECTS/LOG"

# Nginx and Stunnel configuration file names (expected in $envDr, copied from example.env)
export NGINX_CONF_FILENAME="nginx.conf"
export STUNNEL_CONF_FILENAME="stunnel.conf"

# PID file for Nginx
export NGINX_PID_FILE="/run/nginx.pid" # Corrected path, nginx usually creates it in /run/nginx/
